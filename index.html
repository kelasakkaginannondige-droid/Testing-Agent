<!DOCTYPE html>
<html>
<head>
  <title>LiveKit Agent Test</title>
  <script src="https://cdn.jsdelivr.net/npm/livekit-client@latest/dist/livekit-client.umd.js"></script>
</head>
<body>
  <h2>Talk to Your Agent</h2>
  <p>Allow microphone access and start talking!</p>

  <script>
 (async () => {
  const url = "wss://jupyter-1v67alm8.livekit.cloud";
  const token = "eyJhbGciOiJIUzI1NiJ9.eyJ2aWRlbyI6eyJyb29tIjoicm9vbS1mMTM1OWU1YjVjYjEiLCJyb29tSm9pbiI6dHJ1ZSwiY2FuUHVibGlzaCI6dHJ1ZSwiY2FuU3Vic2NyaWJlIjp0cnVlLCJjYW5QdWJsaXNoU291cmNlcyI6WyJtaWNyb3Bob25lIl19LCJpc3MiOiJBUEl6MlJZcTMzcjh0ejYiLCJleHAiOjE3NTk0MjExNzAsIm5iZiI6MCwic3ViIjoidXNlciJ9.W1OjolbDYkqKvO4vLiELoptscVn30M3vR9ftN5e81QE";

  const room = new livekit.Room();

  await room.connect(url, token);

  // Subscribe to agent audio
  room.on("trackSubscribed", (track) => {
    if(track.kind === "audio") {
      const audioEl = document.createElement("audio");
      audioEl.autoplay = true;
      audioEl.srcObject = new MediaStream([track.mediaStreamTrack]);
      document.body.appendChild(audioEl);
    }
  });

  // Capture your microphone and publish
  const localStream = await navigator.mediaDevices.getUserMedia({ audio: true });
  const localTrack = new livekit.LocalAudioTrack(localStream.getAudioTracks()[0]);
  await room.localParticipant.publishTrack(localTrack);

  alert("Connected! Speak into your microphone now.");
})();

  </script>
</body>
</html>


